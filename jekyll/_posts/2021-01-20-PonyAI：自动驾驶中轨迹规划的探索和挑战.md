---
layout: posts
title: PonyAI：自动驾驶中轨迹规划的探索和挑战
tags: 自动驾驶
header: 
  image: "http://zhouzm.cn/images/%E7%BE%8E%E5%9B%BE/210513%E5%9F%8E%E5%B8%823.jpg"
---


## 轨迹规划基本介绍

核心是解决车辆该怎么走的问题：

* 输入：拓扑地图、障碍物、障碍物的预测轨迹、交通信号灯的状态、定位、导航、车辆状态

* 输出：一个 **轨迹**，是时间到位置的函数 `t→(x,y,z)`

<center>💮💮💮</center>

## 为什么需要决策模块

#### 🚘 使轨迹规划化繁为简

限定非凸问题（轨迹规划）的解空间，将问题转化为凸的。

需要决策的场景：

* 抢行/让行
* 冲黄灯
* 在哪两辆车之间变道/并线
* 主动变道
* 从左/右绕行前方障碍物

![](http://8.134.51.249/DailyRead/assets/images/0120-PonyPlanning-1.webp)

#### 🚘 纵向规划决策求解：动态规划

将t - s 图进行 **离散化**；

通过前边两步近似求出加速度，写出一个 **状态转移方程**；

只能一个大概的决策方法，即到底让或者不让，不能保证舒适

![](http://8.134.51.249/DailyRead/assets/images/0120-PonyPlanning-2.webp)

#### 🚘 决策面临的挑战

NP-hard问题，不易直接求解；

很难用规则去拟合人的经验；

场景多变而复杂

<center>💮💮💮</center>

## 横向规划

#### 🚘 横向规划的解法

无车道的场景：业界大多都用搜索等路径生成的方式去处理。

有车道的情况：

* 离线生成 **参考线**
* 将求解 `s→(x,y)` 的问题变为求解 `s→l` 的问题（`l` 是指车辆在这个参考线上的横向偏移量）

![](http://8.134.51.249/DailyRead/assets/images/0120-PonyPlanning-3.webp)

参考线的生成：

* 高精地图
* 约束：在车道线内，控制上可实现
* 优化目标：离参考线近、离障碍物远、曲率不大、曲率变化率不大



#### 🚘 横向规划的挑战

没有车道线；

普通车辆不按车道线行驶；

行驶环境瞬息万变，预测困难；

保证规划的路径光滑且在控制上可实现

<center>💮💮💮</center>

## 纵向规划

#### 🚘 纵向规划的定义和场景

车辆在设定好的路径上的速度规划；

约束：

* 遵守交规
* 避免碰撞

优化目标：

* 乘坐舒适
* 速度变化率不大
* 加速度变化率不大
* 行驶速度尽量快一点

![](http://8.134.51.249/DailyRead/assets/images/0120-PonyPlanning-4.webp)

#### 🚘 纵向规划的挑战

博弈；

激进和保守之间的平衡；

知和预测的困难；

横纵向协调配合



[阅读原文](https://mp.weixin.qq.com/s/cJNQNDrNyttV9a8UK2SkfQ)